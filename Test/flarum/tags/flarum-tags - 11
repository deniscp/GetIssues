
    "url": "https://api.github.com/repos/flarum/tags/issues/11",
    "labels_url": "https://api.github.com/repos/flarum/tags/issues/11/labels{/name}",
    "comments_url": "https://api.github.com/repos/flarum/tags/issues/11/comments",
    "events_url": "https://api.github.com/repos/flarum/tags/issues/11/events",
    "html_url": "https://github.com/flarum/tags/issues/11",
    "id": 103514013,
    "number": 11,
    "title": "Add per-tag unread discussion counts + ability to mark a tag as read",
    "user": {
      "login": "tobscure",
      "id": 128862,
      "avatar_url": "https://avatars.githubusercontent.com/u/128862?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tobscure",
      "html_url": "https://github.com/tobscure",
      "followers_url": "https://api.github.com/users/tobscure/followers",
      "following_url": "https://api.github.com/users/tobscure/following{/other_user}",
      "gists_url": "https://api.github.com/users/tobscure/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tobscure/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tobscure/subscriptions",
      "organizations_url": "https://api.github.com/users/tobscure/orgs",
      "repos_url": "https://api.github.com/users/tobscure/repos",
      "events_url": "https://api.github.com/users/tobscure/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tobscure/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "milestone": null,
    "comments": 0,
    "created_at": "2015-08-27T13:49:27Z",
    "updated_at": "2015-08-27T13:49:35Z",
    "closed_at": null,
    "body": "This is a tricky one. For every user/discussion, there is a record in the database containing the last post number that was read. Flarum says that a discussion is \"unread\" if the discussion's last post number is greater than the user's last read number for that discussion. Also, the last post time must be later than the user's \"mark all as read\" time.\r\n\r\nSo in order to count the number of unread discussions in a certain tag, do we need to compare *all* of the individual discussion last post numbers to the user's last read numbers? And wouldn't that involve one query per tag? That sounds pretty inefficient to me...\r\n\r\nMarking a tag as read is the easy part, because we can just have a \"marked as read\" timestamp for each user/tag combo, and then require the last post time for each discussion with that tag to be greater.\r\n\r\nWhat needs to be done:\r\n\r\n* Figure out a way to implement this efficiently.\r\n* We'll do other planning after we've done that."
  